-- MySQL Script generated by MySQL Workbench
-- Fri Jun  9 21:14:10 2017
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `mydb` ;

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`tipoInventario`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`tipoInventario` (
  `idtipoInventario` INT NOT NULL AUTO_INCREMENT,
  `descripcion` VARCHAR(15) NULL,
  PRIMARY KEY (`idtipoInventario`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`telas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`telas` (
  `idtelas` INT NOT NULL AUTO_INCREMENT,
  `referencia` VARCHAR(7) NULL,
  `descripcion` TEXT(255) NULL,
  `costo` DOUBLE NULL,
  PRIMARY KEY (`idtelas`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`unidaddeMedidas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`unidaddeMedidas` (
  `idunidaddeMedidas` INT NOT NULL AUTO_INCREMENT,
  `descripcion` VARCHAR(10) NULL,
  PRIMARY KEY (`idunidaddeMedidas`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`inventarioTelas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`inventarioTelas` (
  `idinventarioTelas` INT NOT NULL AUTO_INCREMENT,
  `cantidad` DOUBLE NULL,
  `disponible` DOUBLE NULL,
  PRIMARY KEY (`idinventarioTelas`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`estados`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`estados` (
  `idestados` INT NOT NULL AUTO_INCREMENT,
  `descripcion` VARCHAR(45) NULL,
  PRIMARY KEY (`idestados`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`detallesTelas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`detallesTelas` (
  `iddetallesTelas` INT NOT NULL AUTO_INCREMENT,
  `idTipo` INT NOT NULL,
  `idTela` INT NOT NULL,
  `idUniMedida` INT NOT NULL,
  `idInventario` INT NOT NULL,
  `idEstado` INT NOT NULL,
  `rendimiento` DOUBLE NULL,
  `color` VARCHAR(15) NULL,
  `ancho` DOUBLE NULL,
  PRIMARY KEY (`iddetallesTelas`),
  CONSTRAINT `idTela`
    FOREIGN KEY (`idTela`)
    REFERENCES `mydb`.`telas` (`idtelas`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `idTipo`
    FOREIGN KEY (`idTipo`)
    REFERENCES `mydb`.`tipoInventario` (`idtipoInventario`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `idUniMedida`
    FOREIGN KEY (`idUniMedida`)
    REFERENCES `mydb`.`unidaddeMedidas` (`idunidaddeMedidas`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `idInventario`
    FOREIGN KEY (`idInventario`)
    REFERENCES `mydb`.`inventarioTelas` (`idinventarioTelas`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `idEstado`
    FOREIGN KEY (`idEstado`)
    REFERENCES `mydb`.`estados` (`idestados`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;

CREATE INDEX `idTela_idx` ON `mydb`.`detallesTelas` (`idTela` ASC);

CREATE INDEX `idTipo_idx` ON `mydb`.`detallesTelas` (`idTipo` ASC);

CREATE INDEX `idUniMedida_idx` ON `mydb`.`detallesTelas` (`idUniMedida` ASC);

CREATE INDEX `idInventario_idx` ON `mydb`.`detallesTelas` (`idInventario` ASC);

CREATE INDEX `idEstado_idx` ON `mydb`.`detallesTelas` (`idEstado` ASC);


-- -----------------------------------------------------
-- Table `mydb`.`insumos`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`insumos` (
  `idinsumos` INT NOT NULL AUTO_INCREMENT,
  `referencia` VARCHAR(7) NULL,
  `descripcion` TEXT(255) NULL,
  `costo` DOUBLE NULL,
  PRIMARY KEY (`idinsumos`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`inventarioInsumos`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`inventarioInsumos` (
  `idinventarioInsumos` INT NOT NULL AUTO_INCREMENT,
  `cantidad` DOUBLE NULL,
  `disponible` DOUBLE NULL,
  PRIMARY KEY (`idinventarioInsumos`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`detallesInsumos`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`detallesInsumos` (
  `iddetallesInsumos` INT NOT NULL AUTO_INCREMENT,
  `idTipo` INT NOT NULL,
  `idInsumo` INT NOT NULL,
  `idUniMedida` INT NOT NULL,
  `idInventario` INT NOT NULL,
  `idEstado` INT NOT NULL,
  `color` VARCHAR(15) NULL,
  `talla` VARCHAR(10) NULL,
  PRIMARY KEY (`iddetallesInsumos`),
  CONSTRAINT `idTipoI`
    FOREIGN KEY (`idTipo`)
    REFERENCES `mydb`.`tipoInventario` (`idtipoInventario`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `idInsumoI`
    FOREIGN KEY (`idInsumo`)
    REFERENCES `mydb`.`insumos` (`idinsumos`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `idUniMedidaI`
    FOREIGN KEY (`idUniMedida`)
    REFERENCES `mydb`.`unidaddeMedidas` (`idunidaddeMedidas`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `idInventarioI`
    FOREIGN KEY (`idInventario`)
    REFERENCES `mydb`.`inventarioInsumos` (`idinventarioInsumos`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `idEstadoI`
    FOREIGN KEY (`idEstado`)
    REFERENCES `mydb`.`estados` (`idestados`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;

CREATE INDEX `idTipoI_idx` ON `mydb`.`detallesInsumos` (`idTipo` ASC);

CREATE INDEX `idInsumoI_idx` ON `mydb`.`detallesInsumos` (`idInsumo` ASC);

CREATE INDEX `idUniMedidaI_idx` ON `mydb`.`detallesInsumos` (`idUniMedida` ASC);

CREATE INDEX `idInventarioI_idx` ON `mydb`.`detallesInsumos` (`idInventario` ASC);

CREATE INDEX `idEstadoI_idx1` ON `mydb`.`detallesInsumos` (`idEstado` ASC);


-- -----------------------------------------------------
-- Table `mydb`.`perfiles`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`perfiles` (
  `idperfil` INT NOT NULL AUTO_INCREMENT,
  `descripcion` VARCHAR(45) NULL,
  PRIMARY KEY (`idperfil`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`usuarios`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`usuarios` (
  `cedula` VARCHAR(13) NOT NULL,
  `nombre` VARCHAR(90) NULL,
  `email` VARCHAR(90) NULL,
  `usuario` VARCHAR(15) NULL,
  `password` VARCHAR(15) NULL,
  `perfil` INT NOT NULL,
  PRIMARY KEY (`cedula`),
  CONSTRAINT `idPerfil`
    FOREIGN KEY (`perfil`)
    REFERENCES `mydb`.`perfiles` (`idperfil`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;

CREATE INDEX `idPerfil_idx` ON `mydb`.`usuarios` (`perfil` ASC);


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
